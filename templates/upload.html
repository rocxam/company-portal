{% extends "base.html" %}
{% block title %}Upload Staff{% endblock %}
{% block content %}
<h2>Upload Staff</h2>
<form method="post" enctype="multipart/form-data">
  <div class="mb-3">
    <label>Staff Name</label>
    <input class="form-control" name="name" required>
  </div>
  <div class="mb-3">
    <label>Role/Position</label>
    <input class="form-control" name="role" required>
  </div>
  <div class="mb-3">
    <label>Upload File</label>
    <input class="form-control" type="file" name="file" required>
  </div>
  <button class="btn btn-success">Upload</button>
</form>

<h3 class="mt-4">Uploaded Staff</h3>
<div class="row">
  {% for s in staff %}
  <div class="col-md-4">
    <div class="card mb-3">
      {% if s.file.endswith(('png','jpg','jpeg','gif')) %}
        <img src="{{ url_for('uploaded_file', filename=s.file) }}" class="card-img-top" height="200" style="object-fit: cover;">
      {% elif s.file.endswith('pdf') %}
        <iframe src="{{ url_for('uploaded_file', filename=s.file) }}" height="200" class="w-100"></iframe>
      {% else %}
        <video class="w-100" height="200" controls>
          <source src="{{ url_for('uploaded_file', filename=s.file) }}">
        </video>
      {% endif %}
      <div class="card-body">
        <h5 class="card-title">{{ s.name }}</h5>
        <p class="card-text"><strong>Role:</strong> {{ s.role }}</p>
        <p class="card-text"><strong>File:</strong> {{ s.file }}</p>
        <a href="{{ url_for('uploaded_file', filename=s.file) }}" class="btn btn-sm btn-secondary" target="_blank">Open</a>
        {% if s.uploaded_by == user %}
        <form method="POST" action="/request_edit/{{ s.id }}" class="d-inline">
          <button class="btn btn-sm btn-warning">Request Edit</button>
        </form>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}
