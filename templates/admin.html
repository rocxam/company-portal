{% extends "base.html" %}
{% block title %}Admin Panel{% endblock %}
{% block content %}
<h2>Admin Panel</h2>

{% if edit_requests %}
<h3>Pending Edit Requests</h3>
<ul>
  {% for eid in edit_requests %}
  <li>
    Entry ID: {{ eid }}
    <form method="POST" action="/approve_edit/{{ eid }}" class="d-inline">
      <input type="password" name="adminpass" placeholder="Admin password" required class="form-control d-inline" style="width: 200px; display: inline;">
      <button class="btn btn-sm btn-primary">Approve</button>
    </form>
  </li>
  {% endfor %}
</ul>
{% endif %}

<h3 class="mt-4">Uploaded Staff</h3>
<div class="row">
  {% for s in staff %}
  <div class="col-md-4">
    <div class="card mb-3">
      {% if s.file.endswith(('png','jpg','jpeg','gif')) %}
        <img src="{{ url_for('uploaded_file', filename=s.file) }}" class="card-img-top" height="200">
      {% elif s.file.endswith('pdf') %}
        <iframe src="{{ url_for('uploaded_file', filename=s.file) }}" height="200" class="w-100"></iframe>
      {% else %}
        <video class="w-100" height="200" controls>
          <source src="{{ url_for('uploaded_file', filename=s.file) }}">
        </video>
      {% endif %}
      <div class="card-body">
        <h5 class="card-title">{{ s.name }}</h5>
        <p class="card-text"><strong>Role:</strong> {{ s.role }}</p>
        <p class="card-text"><strong>File:</strong> {{ s.file }}</p>
        <a href="{{ url_for('uploaded_file', filename=s.file) }}" class="btn btn-sm btn-secondary" target="_blank">Open</a>
        <form method="POST" action="/delete/{{ s.id }}" class="d-inline">
          <button class="btn btn-sm btn-danger">Delete</button>
        </form>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
<br><a href="/upload" class="btn btn-outline-secondary mt-3">Back to Upload Page</a>
{% endblock %}
